<?xml version="1.0" encoding="UTF-8"?>
<microquake filetype="automatic-processing" site="example" project_code="OT" spark_enabled="False">

	<file_locations>
		<common_file_location value="$SPP_COMMON"/>
	</file_locations>

	<grid>
		<definition method="ODS">
      		<units value="meters"/>
      		<origin X="650200" Y="4766170" Z="-500"/>
      		<dimensions nx="100" ny="101" nz="68"/>
      		<spacing value="25"/>
    	</definition>

		<!-- Can have multiple definitions -->
		<!-- But NLL for now only works with one -->

		<!--<velmodel id="0">-->
			<!--<method homogeneous="false"/>-->
			<!--<velocity vp="Vp.pickle" vs="Vs.pickle" format="PICKLE"/>  -->
		<!--</velmodel>-->
		

		 <velmodel id="0">
			<method homogeneous="true"/>
			<velocity vp="5500" vs="3500"/>
		</velmodel>
		

		<!-- Can have multiple definitions -->
		<denmodel id="0">
			<method homogeneous="true"/>
			<density rho="2700"/>
		</denmodel>
	</grid>

	<!--Can have multiple definitions -->
	<sensors id="0">
		<units value="meters"/>
		<file format="csv" path="sensors.csv"/>
	</sensors>

		<trigger>
        <STALTA_on value="3.0"/>
        <STALTA_off value="1.25"/>
        <STA value="10e-3"/>
		<LTA value="100e-3"/>
        <onset_threshold value="3"/> <!-- STALTA function threshold to declare a trigger -->
        <max_trigger_length value="0.05"/> <!-- maximum trigger length to declare a trigger valid -->
        <association_time value="0.1"/> <!-- length of time window within which triggers are associated -->
        <hold_off_time value="0.1"/> <!-- hold off time after an event has been detected to trigger another event -->
        <min_number_trigger value="4"/>  <!-- minimum number of trigger required to declare an event -->
        <seismogram_length value="300"/> <!-- resulting seismograms length -->
	</trigger>
	<autopicker>
	  <min_picks value="6"/> <!--Minimum number of picks to accept an event-->
		<rms_residual_threshold value="0.02"/> <!--rms residual threshold to accept an event-->
		<uncertainty_threshold value="40"/> <!-- uncertainty threshold in m -->
		<accelerometer SNR_threshold="0"/>
		<geophone SNR_threshold="0"/>

		<polarity average_time_window="1e-3" hp_filter_freq="100"/>

		<STALTA_picker>
			<accelerometer nphase="2" nsta="1e-3" nlta="10e-3" SNR_window="5e-3"/>
			<geophone nphase="2" nsta="1e-3" nlta="10e-3" SNR_window="5e-3"/>
		</STALTA_picker>
		<SNR_picker>
			<accelerometer SNR_dt="np.linspace(-5e-3, 5e-3, 5000)" SNR_window="(0.003, 0.003)"/>
			<geophone SNR_dt="np.linspace(-5e-3, 5e-3, 5000)" SNR_window="(0.003, 0.003)"/>
		</SNR_picker>
	</autopicker>
	<calcsourceparams>
		<win_length value="0.01"/> <!-- window width over which the source parameters are calculated -->
		<only_triaxial value="True"/> <!-- use only triaxial sensors for source parameter calculater -->
		<min_dist value="20"/> <!-- minimum distance between source and receiver in meter -->
	</calcsourceparams>
	<calcparams>
		<STA value="20e-3"/> 			<!-- Short-term average triggering cutoff -->
		<LTA value="200e-3"/> 			<!-- Long-term average triggering cutoff -->
		<NLL>
			<NLL_BASE value="NLL"/>
			<locsig value="Oyu Tolgoi Geotechnical Monitoring Team"/>
			<loccom value="Test"/>

			<locsearch value="OCT 20 20 20 1e-6 50000 1000 0 1"/>
			<locmeth value="GAU_ANALYTIC 9999.0 4 -1 -1 -1 0"/>
		</NLL>
	</calcparams>

	<spark> <!-- spark properties. Replace dot (.) by underscore (_) -->
		<spark_master value="local[8]"/>
		<spark_app_name value="Auto_process_OT"/>
	</spark>

</microquake>
